# HTTP ä»£ç†ç«¯å£
port: 7890

# SOCKS5 ä»£ç†ç«¯å£
socks-port: 7891

# Linux å’Œ macOS çš„ redir ä»£ç†ç«¯å£
redir-port: 7892

# å…è®¸å±€åŸŸç½‘çš„è¿æ¥
allow-lan: true

# è§„åˆ™æ¨¡å¼ï¼šRuleï¼ˆè§„åˆ™ï¼‰ / Globalï¼ˆå…¨å±€ä»£ç†ï¼‰/ Directï¼ˆå…¨å±€ç›´è¿ï¼‰
mode: Rule

# è®¾ç½®æ—¥å¿—è¾“å‡ºçº§åˆ« (é»˜è®¤çº§åˆ«ï¼šsilentï¼Œå³ä¸è¾“å‡ºä»»ä½•å†…å®¹ï¼Œä»¥é¿å…å› æ—¥å¿—å†…å®¹è¿‡å¤§è€Œå¯¼è‡´ç¨‹åºå†…å­˜æº¢å‡ºï¼‰ã€‚
# 5 ä¸ªçº§åˆ«ï¼šsilent / info / warning / error / debugã€‚çº§åˆ«è¶Šé«˜æ—¥å¿—è¾“å‡ºé‡è¶Šå¤§ï¼Œè¶Šå€¾å‘äºè°ƒè¯•ï¼Œè‹¥éœ€è¦è¯·è‡ªè¡Œå¼€å¯ã€‚
log-level: info
# Clash çš„ RESTful API
external-controller: "0.0.0.0:9090"

# RESTful API çš„å£ä»¤
secret: ""

# æ‚¨å¯ä»¥å°†é™æ€ç½‘é¡µèµ„æºï¼ˆå¦‚ clash-dashboardï¼‰æ”¾ç½®åœ¨ä¸€ä¸ªç›®å½•ä¸­ï¼Œclash å°†ä¼šæœåŠ¡äº `RESTful API/ui`
# å‚æ•°åº”å¡«å†™é…ç½®ç›®å½•çš„ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„ã€‚
# external-ui: folder

dns:
  enable: true
  ipv6: false
  listen: 0.0.0.0:53
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  hosts:
    "nas.tutool.top": 192.168.3.1
    "one-api.tutool.top": 192.168.3.1
    "new-api.tutool.top": 192.168.3.1
    "tutool.top": 192.168.3.1
  nameserver:
    - 192.168.3.1
    - 223.5.5.5
    - 8.8.8.8
    - 119.29.29.29
    - 1.0.0.1
  nameserver-policy:
    "*.tutool.top": 192.168.3.1 # ä½¿ç”¨ç³»ç»ŸDNSï¼ˆè·¯ç”±å™¨ï¼‰
    "tutool.top": 192.168.3.1 # ä½¿ç”¨ç³»ç»ŸDNSï¼ˆè·¯ç”±å™¨ï¼‰

  fallback:
    - https://dns.google/dns-query
    - https://doh.opendns.com/dns-query
    - https://doh.pub/dns-query
    - tls://dns.google
  fallback-filter:
    geoip: true
    ipcidr:
      - 240.0.0.0/4
  fake-ip-filter:
    - +.tutool.top # æ–°å¢
    - tutool.top

# Clash DNS è¯·æ±‚é€»è¾‘ï¼š
# (1) å½“è®¿é—®ä¸€ä¸ªåŸŸåæ—¶ï¼Œ nameserver ä¸ fallback åˆ—è¡¨å†…çš„æ‰€æœ‰æœåŠ¡å™¨å¹¶å‘è¯·æ±‚ï¼Œå¾—åˆ°åŸŸåå¯¹åº”çš„ IP åœ°å€ã€‚
# (2) clash å°†é€‰å– nameserver åˆ—è¡¨å†…ï¼Œè§£ææœ€å¿«çš„ç»“æœã€‚
# (3) è‹¥è§£æç»“æœä¸­ï¼ŒIP åœ°å€å±äº å›½å¤–ï¼Œé‚£ä¹ˆ Clash å°†é€‰æ‹© fallback åˆ—è¡¨å†…ï¼Œè§£ææœ€å¿«çš„ç»“æœã€‚

# æ³¨æ„ï¼š
# (1) å¦‚æœæ‚¨ä¸ºäº†ç¡®ä¿ DNS è§£æç»“æœæ— æ±¡æŸ“ï¼Œè¯·ä»…ä¿ç•™åˆ—è¡¨å†…ä»¥ tls:// å¼€å¤´çš„ DNS æœåŠ¡å™¨ï¼Œä½†æ˜¯é€šå¸¸å¯¹äºå›½å†…æ²¡æœ‰å¤ªå¤§å¿…è¦ã€‚
# (2) å¦‚æœæ‚¨ä¸åœ¨ä¹å¯èƒ½è§£æåˆ°æ±¡æŸ“çš„ç»“æœï¼Œæ›´åŠ è¿½æ±‚é€Ÿåº¦ã€‚è¯·å°† nameserver åˆ—è¡¨çš„æœåŠ¡å™¨æ’å…¥è‡³ fallback åˆ—è¡¨å†…ï¼Œå¹¶ç§»é™¤é‡å¤é¡¹ã€‚

tun:
  enable: true #å¦‚æœéœ€è¦å¯ç”¨ TUN æ¨¡å¼ï¼Œè¯·è®¾ç½®ä¸º true
  stack: system # æˆ– gvisor
  macOS-auto-route: true
  macOS-auto-detect-interface: true
  dns-hijack:
    - tcp://8.8.8.8:53
    - tcp://8.8.4.4:53

# è„šæœ¬
# script:
#   shortcuts:
#     sshproxy: dst_port == 22 and (geoip(resolve_ip(host)) != 'CN' or geoip(dst_ip) != 'CN')

# è§„åˆ™
rules:
  # å¹¿å‘Šç¦æ­¢
  - DOMAIN-SUFFIX,access-sngapm.qcloud.com, â›”ï¸ å¹¿å‘Šæ‹¦æˆª

  # æœ¬åœ°/å±€åŸŸç½‘åœ°å€
  - DOMAIN-SUFFIX,ip6-localhost,ğŸ”° å›½å†…ç›´è¿
  - DOMAIN-SUFFIX,ip6-loopback,ğŸ”° å›½å†…ç›´è¿
  - DOMAIN-SUFFIX,local,ğŸ”° å›½å†…ç›´è¿
  - DOMAIN-SUFFIX,localhost,ğŸ”° å›½å†…ç›´è¿
  - IP-CIDR,10.0.0.0/8,ğŸ”° å›½å†…ç›´è¿
  - IP-CIDR,100.64.0.0/10,ğŸ”° å›½å†…ç›´è¿
  - IP-CIDR,127.0.0.0/8,ğŸ”° å›½å†…ç›´è¿
  - IP-CIDR,172.16.0.0/12,ğŸ”° å›½å†…ç›´è¿
  - IP-CIDR,192.168.0.0/16,ğŸ”° å›½å†…ç›´è¿
  - IP-CIDR,198.18.0.0/16,ğŸ”° å›½å†…ç›´è¿
  - IP-CIDR6,::1/128,ğŸ”° å›½å†…ç›´è¿
  - IP-CIDR6,fc00::/7,ğŸ”° å›½å†…ç›´è¿
  - IP-CIDR6,fe80::/10,ğŸ”° å›½å†…ç›´è¿
  - IP-CIDR6,fd00::/8,ğŸ”° å›½å†…ç›´è¿

  # ç›´è¿
  - DOMAIN-SUFFIX,tsinghua.edu.cn,ğŸ”° å›½å†…ç›´è¿
  - DOMAIN-SUFFIX,doubanio.com,ğŸ”° å›½å†…ç›´è¿
  - DOMAIN-SUFFIX,aliyun.com,ğŸ”° å›½å†…ç›´è¿
  - DOMAIN-SUFFIX,edu.cn,ğŸ”° å›½å†…ç›´è¿
  - DOMAIN-SUFFIX,translate.googleapis.com,ğŸ”° å›½å†…ç›´è¿
  - DOMAIN-SUFFIX,battle.net,ğŸ”° å›½å†…ç›´è¿
  - DOMAIN-SUFFIX,gov.cn,ğŸ”° å›½å†…ç›´è¿
  - DOMAIN-SUFFIX,1password.com,ğŸ”° å›½å†…ç›´è¿
  - DOMAIN-SUFFIX,tutool.top,ğŸ”° å›½å†…ç›´è¿

  # ChatGPT
  - DOMAIN-SUFFIX,openai.com,ğŸ¤– ChatGPT
  - DOMAIN-SUFFIX,bing.com,ğŸ¤– ChatGPT
  - DOMAIN-SUFFIX,gemini.google.com,ğŸ¤– ChatGPT
  - DOMAIN-SUFFIX,ciciai.com,ğŸ¤– ChatGPT
  - DOMAIN-SUFFIX,chatgpt.com,ğŸ¤– ChatGPT
  - DOMAIN-SUFFIX,googleapis.com,ğŸ¤– ChatGPT
  - DOMAIN-SUFFIX,openrouter.ai,ğŸ¤– ChatGPT

  # éé€šç”¨ç½‘ç»œ
  - DOMAIN-SUFFIX,cloudfront.net,â„¢ï¸éé€šç”¨ç½‘ç»œ
  - DOMAIN-SUFFIX,github.com,â„¢ï¸éé€šç”¨ç½‘ç»œ

  # å‡ºå›½èµ·é£
  - DOMAIN-SUFFIX,facebook.com,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,v2ex.com,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,hk1lib.org,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,z-lib.org,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,hk1lib.org,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,sg1lib.org,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,zlibcdn.com,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,apps.apple.com,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,notion.so,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,deepl.com,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,raindrop.io,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,adguard.com,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,live.com,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,appcenter.ms,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,javdb.com,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,javbus.com,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,api.chatanywhere.cn,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,api.chatanywhere.tech,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,api2.aigcbest.top,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,challenges.cloudflare.com,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,copilot.microsoft.com,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,discordapp.net,âœˆï¸ èµ·é£å‡ºå›½
  - DOMAIN-SUFFIX,futunn.com,âœˆï¸ èµ·é£å‡ºå›½
  # è®¢é˜…è§„åˆ™
  - RULE-SET,Disney+,ğŸ…³ Disney+
  - RULE-SET,Microsoft,ğŸ¤– ChatGPT
  
  # SSH èŠ‚ç‚¹
  # - SCRIPT,sshproxy,ğŸ–¥ï¸ SSHèŠ‚ç‚¹
  - DST-PORT,22,ğŸ–¥ï¸ SSHèŠ‚ç‚¹

rule-providers:
  Disney+:
    {
      type: http,
      behavior: classical,
      path: ./Filter/DisneyPlus,
      url: https://raw.githubusercontent.com/pzg417/rules/111a98098ff7a293080d3727f88bb32e5052ceca/Disney_Plus,
      interval: 3600,
    }
  Microsoft:
    {
      type: http,
      behavior: classical,
      path: ./Filter/Microsoft,
      url: https://raw.githubusercontent.com/Semporia/Clash/a5e52de7e4fd3851a9b03500b9e4763902069e7f/Rule/Microsoft.yaml,
      interval: 3600,
    }
